import telebot, time, schedule, threading, os, random

bot = telebot.TeleBot("TOKEN")


# all functions

def menu():
    return(
        '/start - приветствие\n'
        '/menu - доступные команды\n'
        '/enot - руководство по обучению енота\n'
        '/image - картинки для запугивания\n'
        '/set n - бесконечные причины, почему нам надо беречь экологию\n'
        '/unset - остановить таймер с причинами\n'
    )


def r():
    list = ['Я не хочу жить на марсе', 'Я не хочу умирать', 'В космосе холодно и темно', 'Еноты конечно милые, но я покахочу пожить', 'Котики милее енотов', 'На марсе нет кислого мармелада', 'Котики на марсе жить не смогут']
    a = random.choice(list)
    return a


def enot():
    return(
        'Вы попали на пошаговое руководство по обучение енота. Пожалуйста, выберите пункт руководства, на котором вы остановились:\n'
        '/1 - Шаг 1. Установите доверительные отношения\n'
        '/2 - Шаг 2. Обучите базовым навыкам выживания\n'
        '/3 - Шаг 3. Освойте азбуку Морзе (на случай отсутствия Wi‑Fi)\n'
        '/4 - Шаг 4. Подготовьте енота к роли хранителя знаний\n'
        '/5 - Шаг 5. Научите пользоваться простейшими инструментами\n'
        '/6 - Шаг 6. Проведите финальное испытание «День сурка, но с енотом»\n'
        '/7 - Бонус: памятка для ученика‑енота\n'
    )

def p_1():
    return(
        'Шаг 1. Установите доверительные отношения\n\n'
        'Начните с угощения: предложите еноту что‑нибудь вкусное (но не всё сразу — иначе обучение закончится на этом этапе). Помните: еноты ценят искренность и закуски. Поглаживания разрешены только после того, как енот сам решит, что вы достойны его доверия. Если он пытается стащить у вас часы — это хороший знак: значит, он видит в вас потенциального союзника, а не просто ходячий автомат с едой.\n\n'
        '/2 - следующий пункт')

def p_2():
    return('Шаг 2. Обучите базовым навыкам выживания\n\n'
           'Научите енота:\n'
           '- открывать банки (это его природное призвание, но пусть делает это аккуратно);\n'
           '- различать съедобное и несъедобное (например, батарейки — не десерт);\n'
           '- прятать запасы на «чёрный день».\n\n'
           'Используйте метод положительного подкрепления: за каждое выполненное задание — кусочек лакомства. За попытку съесть учебник по выживанию — строгий взгляд и лишение десерта.\n\n'
           '/3 - следующий пункт')

def p_3():
    return('Шаг 3. Освойте азбуку Морзе (на случай отсутствия Wi‑Fi)\n\n'
           'Еноты отлично манипулируют предметами, поэтому пусть стучат лапками по металлическим поверхностям:\n'
           '- один стук — «опасность»;\n'
           '- два стука — «еда»;\n'
           '- три стука — «я опять что‑то сломал, но это не я».\n\n'
           'Практикуйтесь ежедневно. Если енот начинает использовать азбуку Морзе для заказа пиццы — вы на верном пути.\n\n'
           '/4 - следующий пункт')

def p_4():
    return('Шаг 4. Подготовьте енота к роли хранителя знаний\n\n'
           'Повесьте на стену карту звёздного неба или схему метро (на выбор). Показывайте еноту важные объекты и просите их запомнить. Для проверки дайте ему фонарик и команду «Найди библиотеку». Если енот вместо этого находит кладовку с консервами — повторите упражнение. Через несколько попыток он поймёт, что знания важнее закусок (ну, почти).\n\n'
           '/5 - следующий пункт')

def p_5():
    return('Шаг 5. Научите пользоваться простейшими инструментами\n\n'
           'Цель: енот должен уметь:\n'
           '- держать гаечный ключ (для ремонта убежища);\n'
           '- включать фонарик (чтобы не блуждать в темноте);\n'
           '- аккуратно листать книгу (если вдруг найдёте уцелевшую библиотеку).\n\n'
           'Начните с малого: дайте еноту палочку и попросите построить шалаш. Если вместо шалаша получится куча обломков и довольный енот — похвалите его за креативность и начните заново.\n\n'
           '/6 - следующий пункт')

def p_6():
    return('Шаг 6. Проведите финальное испытание «День сурка, но с енотом»\n\n'
           'Создайте смоделированную чрезвычайную ситуацию:\n'
           '1. Разбросайте «ресурсы» (орехи, банки, верёвки) по комнате.\n'
           '2. Изобразите «катастрофу» (выключите свет, включите тревожную музыку).\n'
           '3. Дайте еноту задание: собрать припасы, починить «генератор» (игрушечную машинку с лампочкой) и подать сигнал бедствия (постучать азбукой Морзе).\n\n'
           'Если енот вместо выполнения задания устраивает дискотеку с консервной банкой — не отчаивайтесь. Просто добавьте в программу обучения курс по дисциплине. А пока… пусть будет главным по развлечениям в постапокалиптическом мире.\n\n'
           '/7 - следующий пункт')

def p_7():
    return('Бонус: памятка для ученика‑енота\n\n'
           '- Правило № 1: не ешьте то, что светится в темноте.\n'
           '- Правило № 2: если не можете открыть — попробуйте перевернуть.\n'
           '- Правило № 3: в случае сомнений — обвините белку. Они всё равно не умеют говорить.\n\n'
           '/menu - вернуться на главную')





@bot.message_handler(commands=['start'])
def send_welcome(message):
    bot.reply_to(message, "Привет! Я твой Telegram бот. Напиши что-нибудь!\n" + menu())

@bot.message_handler(commands = ['menu'])
def menu_xz(message):
    bot.reply_to(message, menu())



path = r'C:\Users\pc\OneDrive\Desktop\python_a_k\bot_eco\bot\images'
img = os.listdir(path)


@bot.message_handler(commands=['image'])
def image(message) -> None:
    filename = random.choice(img)
    full_path = os.path.join(path, filename)
    with open(full_path, 'rb') as f:   
        bot.send_photo(message.chat.id, f)


def reason(chat_id) -> None:
    """Send the beep message."""
    bot.send_message(chat_id, r())


@bot.message_handler(commands=['set'])
def set_timer(message):
    args = message.text.split()
    if len(args) > 1 and args[1].isdigit():
        sec = int(args[1])
        schedule.every(sec).seconds.do(reason, message.chat.id).tag(message.chat.id)
    else:
        bot.reply_to(message, 'Usage: /set <seconds>')


@bot.message_handler(commands=['unset'])
def unset_timer(message):
    schedule.clear(message.chat.id)

# руководство по обучению енота
@bot.message_handler(commands=['enot'])
def r_enot(message):
    bot.reply_to(message, enot())

# пункты руководства
@bot.message_handler(commands=['1'])
def p1_1(message):
    bot.reply_to(message, p_1())

@bot.message_handler(commands=['2'])
def p1_2(message):
    bot.reply_to(message, p_2())

@bot.message_handler(commands=['3'])
def p1_3(message):
    bot.reply_to(message, p_3())

@bot.message_handler(commands=['4'])
def p1_4(message):
    bot.reply_to(message, p_4())

@bot.message_handler(commands=['5'])
def p1_5(message):
    bot.reply_to(message, p_5())

@bot.message_handler(commands=['6'])
def p1_6(message):
    bot.reply_to(message, p_6())

@bot.message_handler(commands=['7'])
def p1_7(message):
    bot.reply_to(message, p_7())



if __name__ == '__main__':
    threading.Thread(target=bot.infinity_polling, name='bot_infinity_polling', daemon=True).start()
    while True:
        schedule.run_pending()
        time.sleep(1)
